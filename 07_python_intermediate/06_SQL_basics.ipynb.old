{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### **SQL Basics**\n",
    "Structured Query Language (SQL) is the standard language for managing and manipulating relational databases. It enables users to perform tasks such as querying data, updating records, and managing database structures. Understanding SQL is essential for anyone working with databases, as it provides a powerful and efficient way to interact with data.\n",
    "\n",
    "Key Concepts:\n",
    "\n",
    "- Database: A collection of organized data stored and accessed electronically.\n",
    "- Table: A set of data elements organized in rows and columns within a database.\n",
    "- Query: A request for data or information from a database.\n",
    "- Primary Key: A unique identifier for a record in a table.\n",
    "- Foreign Key: A field in one table that uniquely identifies a row of another table.\n",
    "\n",
    "SQL allows for querying and modifying data, as well as performing various operations like filtering, sorting, and grouping.\n",
    "\n",
    "Common SQL Commands:\n",
    "- SELECT: Retrieve data from one or more tables.\n",
    "- INSERT: Add new records into a table.\n",
    "- UPDATE: Modify existing records.\n",
    "- DELETE: Remove records from a table.\n",
    "- JOIN: Combine rows from two or more tables based on a related column."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "Objective: Create a new database named 'Company' and a table 'Employees' with columns for ID, Name, and Department.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# TODO: Add error handling to manage potential exceptions during database operations.\n",
    "try:\n",
    "    # Connect to the database (or create it if it doesn't exist)\n",
    "    conn = sqlite3.connect('Company.db')\n",
    "    cursor = conn.cursor()\n",
    "\n",
    "    # Create the 'Employees' table\n",
    "    cursor.execute('''\n",
    "        CREATE TABLE IF NOT EXISTS Employees (\n",
    "            ID INTEGER PRIMARY KEY,\n",
    "            Name TEXT NOT NULL,\n",
    "            Department TEXT NOT NULL\n",
    "        )\n",
    "    ''')\n",
    "except Exception as e:\n",
    "    print(f\"Error exception : {e}\")\n",
    "finally:\n",
    "    # Commit the changes and close the connection\n",
    "    conn.commit()\n",
    "    conn.close()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Employee Management System\n",
      "Press 1 to input new data\n",
      "Press 2 to view all data\n",
      "Press 0 to exit\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (10, 'Jhon', 'Finance')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 10 : Jhon : Finance\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (10, 'Jhon', 'Finance')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 10 : Jhon : Finance\n",
      "input new data\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (10, 'Jhon', 'Finance'), (11, 'Indra', 'IT'), (12, 'Joseph', 'SIENCE')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 10 : Jhon : Finance\n",
      "9. 11 : Indra : IT\n",
      "10. 12 : Joseph : SIENCE\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Insert sample employee records into the 'Employees' table.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# # Connect to the database\n",
    "# conn = sqlite3.connect('Company.db')\n",
    "# cursor = conn.cursor()\n",
    "\n",
    "# # Insert sample records\n",
    "# employees = [\n",
    "#     (1, 'Alice Johnson', 'HR'),\n",
    "#     (2, 'Bob Smith', 'Engineering'),\n",
    "#     (3, 'Charlie Davis', 'Marketing')\n",
    "# ]\n",
    "\n",
    "# cursor.executemany('''\n",
    "#     INSERT INTO Employees (ID, Name, Department)\n",
    "#     VALUES (?, ?, ?)\n",
    "# ''', employees)\n",
    "\n",
    "# # Commit the changes and close the connection\n",
    "# conn.commit()\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Implement a function to insert a new employee record with user input.\n",
    "\n",
    "def insert_last_id(table_name:str):\n",
    "    def decorator(func):\n",
    "        def wrapper(*args, **kwargs):\n",
    "\n",
    "            try:\n",
    "                # Connect to the database\n",
    "                conn = sqlite3.connect('Company.db')\n",
    "                cursor = conn.cursor()\n",
    "\n",
    "                cursor.execute(f'''\n",
    "                    SELECT ID FROM {table_name} order by ID DESC limit 1;\n",
    "                ''')\n",
    "\n",
    "                result = cursor.fetchone()\n",
    "                last_id = result[0] if result else 0\n",
    "            except Exception as e:\n",
    "                print(f\"Error exception : {e}\")\n",
    "                last_id = 0\n",
    "            finally:\n",
    "                # Commit the changes and close the connection\n",
    "                conn.commit()\n",
    "                conn.close()\n",
    "\n",
    "            return func(*args, **kwargs, last_id=last_id)\n",
    "        \n",
    "        return wrapper\n",
    "    \n",
    "    return decorator\n",
    "\n",
    "@insert_last_id('Employees')\n",
    "def get_user_input(n: int, last_id: int):\n",
    "    if n == 1 :\n",
    "        name = str(input(f\"name : \"))\n",
    "        department = str(input(\"department : \"))\n",
    "\n",
    "        return [(last_id+1, name, department)]\n",
    "    else:\n",
    "        data = []\n",
    "        for i in range(1, n+1):\n",
    "            name = str(input(f\"name {i} : \"))\n",
    "            department = str(input(f\"department {i} : \"))\n",
    "\n",
    "            data.append((last_id+i, name, department))\n",
    "\n",
    "        return data\n",
    "\n",
    "def insert_new_employee(data):\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        cursor.executemany('''\n",
    "            INSERT INTO Employees (ID, Name, Department)\n",
    "            VALUES (?, ?, ?)\n",
    "        ''', data)\n",
    "\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "def fetch_all_employee():\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        cursor.execute(f'''\n",
    "            SELECT * FROM Employees;\n",
    "        ''')\n",
    "\n",
    "        result = cursor.fetchall()\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "        result = []\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "    return result\n",
    "\n",
    "def main():\n",
    "    print(\"Employee Management System\")\n",
    "    print(\"Press 1 to input new data\")\n",
    "    print(\"Press 2 to view all data\")\n",
    "    print(\"Press 0 to exit\")\n",
    "\n",
    "    while True:\n",
    "        menu_input = int(input(\">> : \\n\"))\n",
    "\n",
    "        if menu_input == 1:\n",
    "            print(\"input new data\")\n",
    "            try:\n",
    "                number_of_input = int(input(\"number data will be input : \"))\n",
    "            except Exception as e:\n",
    "                print(\"invalid input \")\n",
    "                number_of_input = 1\n",
    "                print(f\"number of data is set to {number_of_input}\")\n",
    "            \n",
    "            result = get_user_input(number_of_input)\n",
    "\n",
    "            insert_new_employee(result)\n",
    "\n",
    "        if menu_input == 2:\n",
    "            print(\"view all data\")\n",
    "            data = fetch_all_employee()\n",
    "            print(\"data : \", data)\n",
    "            for index, (id, name, department) in enumerate(data):\n",
    "                print(f\"{index}. {id} : {name} : {department}\")\n",
    "\n",
    "        if menu_input == 0:\n",
    "            break\n",
    "    \n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    main()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(6, 'Lorem', 'IT')\n",
      "(9, 'khilmi', 'IT')\n",
      "(11, 'Indra', 'IT')\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Retrieve and display all employee records from the 'Employees' table.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# # Connect to the database\n",
    "# conn = sqlite3.connect('Company.db')\n",
    "# cursor = conn.cursor()\n",
    "\n",
    "# # Retrieve all records\n",
    "# cursor.execute('SELECT * FROM Employees')\n",
    "# rows = cursor.fetchall()\n",
    "\n",
    "# # Display the records\n",
    "# for row in rows:\n",
    "#     print(row)\n",
    "\n",
    "# # Close the connection\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Modify the query to retrieve employees from a specific department.\n",
    "\n",
    "# Connect to the database\n",
    "conn = sqlite3.connect('Company.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "department = 'it'\n",
    "\n",
    "# Retrieve all records\n",
    "cursor.execute(f'SELECT * FROM Employees WHERE LOWER(Department) = \"{department}\"')\n",
    "rows = cursor.fetchall()\n",
    "\n",
    "# Display the records\n",
    "for row in rows:\n",
    "    print(row)\n",
    "\n",
    "# Close the connection\n",
    "conn.close()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Employee Management System\n",
      "Press 1 to update employee department\n",
      "Press 2 to view all employee\n",
      "Press 0 to exit\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (7, 'Ipsum', 'Finance'), (8, '', '')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 7 : Ipsum : Finance\n",
      "7. 8 :  : \n",
      "update employee department\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (7, 'Ipsum', 'HR'), (8, '', '')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 7 : Ipsum : HR\n",
      "7. 8 :  : \n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "invalid literal for int() with base 10: ''",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[15], line 93\u001b[0m\n\u001b[1;32m     90\u001b[0m             \u001b[38;5;28;01mbreak\u001b[39;00m\n\u001b[1;32m     92\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;18m__name__\u001b[39m \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m__main__\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m---> 93\u001b[0m     \u001b[43mmain\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n",
      "Cell \u001b[0;32mIn[15], line 69\u001b[0m, in \u001b[0;36mmain\u001b[0;34m()\u001b[0m\n\u001b[1;32m     66\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPress 0 to exit\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m     68\u001b[0m \u001b[38;5;28;01mwhile\u001b[39;00m \u001b[38;5;28;01mTrue\u001b[39;00m:\n\u001b[0;32m---> 69\u001b[0m     menu_input \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mint\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;28;43minput\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m>> : \u001b[39;49m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     71\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m menu_input \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m     72\u001b[0m         \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mupdate employee department\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[0;31mValueError\u001b[0m: invalid literal for int() with base 10: ''"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Update the department of an employee in the 'Employees' table.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# # Connect to the database\n",
    "# conn = sqlite3.connect('Company.db')\n",
    "# cursor = conn.cursor()\n",
    "\n",
    "# # Update the department for employee with ID 2\n",
    "# cursor.execute('''\n",
    "#     UPDATE Employees\n",
    "#     SET Department = ?\n",
    "#     WHERE ID = ?\n",
    "# ''', ('Sales', 2))\n",
    "\n",
    "# # Commit the changes and close the connection\n",
    "# conn.commit()\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Implement a function to update an employee's department based on user input.\n",
    "\n",
    "def update_employee_department(employee_id: int, new_department: str):\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "        # Update the department for the specified employee ID\n",
    "        cursor.execute('''\n",
    "            UPDATE Employees\n",
    "            SET Department = ?\n",
    "            WHERE ID = ?\n",
    "        ''', (new_department, employee_id))\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "    \n",
    "def fetch_all_employee():\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        cursor.execute(f'''\n",
    "            SELECT * FROM Employees;\n",
    "        ''')\n",
    "\n",
    "        result = cursor.fetchall()\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "        result = []\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "    return result\n",
    "\n",
    "def main():\n",
    "    print(\"Employee Management System\")\n",
    "    print(\"Press 1 to update employee department\")\n",
    "    print(\"Press 2 to view all employee\")\n",
    "    print(\"Press 0 to exit\")\n",
    "\n",
    "    while True:\n",
    "        menu_input = int(input(\">> : \\n\"))\n",
    "\n",
    "        if menu_input == 1:\n",
    "            print(\"update employee department\")\n",
    "            try:\n",
    "                employee_id = int(input(\"employee id : \"))\n",
    "                new_department = str(input(\"new department : \"))\n",
    "            except Exception as e:\n",
    "                print(\"invalid input \")\n",
    "                continue\n",
    "            \n",
    "            update_employee_department(employee_id, new_department)\n",
    "        \n",
    "        if menu_input == 2:\n",
    "            print(\"view all data\")\n",
    "            data = fetch_all_employee()\n",
    "            print(\"data : \", data)\n",
    "            for index, (id, name, department) in enumerate(data):\n",
    "                print(f\"{index}. {id} : {name} : {department}\")\n",
    "\n",
    "        if menu_input == 0:\n",
    "            break\n",
    "    \n",
    "if __name__ == \"__main__\":\n",
    "    main()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Employee Management System\n",
      "Press 1 to delete employee\n",
      "Press 2 to view all employee\n",
      "Press 0 to exit\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (10, 'Jhon', 'Finance'), (11, 'Indra', 'IT'), (12, 'Joseph', 'SIENCE')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 10 : Jhon : Finance\n",
      "9. 11 : Indra : IT\n",
      "10. 12 : Joseph : SIENCE\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (10, 'Jhon', 'Finance'), (11, 'Indra', 'IT'), (12, 'Joseph', 'SIENCE')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 10 : Jhon : Finance\n",
      "9. 11 : Indra : IT\n",
      "10. 12 : Joseph : SIENCE\n",
      "delete employee\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (11, 'Indra', 'IT'), (12, 'Joseph', 'SIENCE')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 11 : Indra : IT\n",
      "9. 12 : Joseph : SIENCE\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Delete an employee record from the 'Employees' table.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# # Connect to the database\n",
    "# conn = sqlite3.connect('Company.db')\n",
    "# cursor = conn.cursor()\n",
    "\n",
    "# # Delete the employee with ID 3\n",
    "# cursor.execute('''\n",
    "#     DELETE FROM Employees\n",
    "#     WHERE ID = ?\n",
    "# ''', (3,))\n",
    "\n",
    "# # Commit the changes and close the connection\n",
    "# conn.commit()\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Implement a function to delete an employee record based on user input.\n",
    "def delete_employee(employee_id: int):\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        # Delete the employee with the specified ID\n",
    "        cursor.execute('''\n",
    "            DELETE FROM Employees\n",
    "            WHERE ID = ?\n",
    "        ''', (employee_id,))\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "def fetch_all_employee():\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        cursor.execute(f'''\n",
    "            SELECT * FROM Employees;\n",
    "        ''')\n",
    "\n",
    "        result = cursor.fetchall()\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "        result = []\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "    return result\n",
    "\n",
    "def main():\n",
    "    print(\"Employee Management System\")\n",
    "    print(\"Press 1 to delete employee\")\n",
    "    print(\"Press 2 to view all employee\")\n",
    "    print(\"Press 0 to exit\")\n",
    "\n",
    "    while True:\n",
    "        menu_input = int(input(\">> : \\n\"))\n",
    "\n",
    "        if menu_input == 1:\n",
    "            print(\"delete employee\")\n",
    "            try:\n",
    "                employee_id = int(input(\"employee id : \"))\n",
    "            except Exception as e:\n",
    "                print(\"invalid input \")\n",
    "                continue\n",
    "            \n",
    "            delete_employee(employee_id)\n",
    "        \n",
    "        if menu_input == 2:\n",
    "            print(\"view all data\")\n",
    "            data = fetch_all_employee()\n",
    "            print(\"data : \", data)\n",
    "            for index, (id, name, department) in enumerate(data):\n",
    "                print(f\"{index}. {id} : {name} : {department}\")\n",
    "\n",
    "        if menu_input == 0:\n",
    "            break\n",
    "    \n",
    "if __name__ == \"__main__\":\n",
    "    main()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Employee Management System\n",
      "Press 1 to delete employee\n",
      "Press 2 to view all employee\n",
      "Press 0 to exit\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (11, 'Indra', 'IT'), (12, 'Joseph', 'SIENCE')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 11 : Indra : IT\n",
      "9. 12 : Joseph : SIENCE\n",
      "delete employee\n",
      "view all data\n",
      "data :  [(1, 'Alice Johnson', 'HR'), (2, 'Bob Smith', 'Engineering'), (3, 'Charlie Davis', 'Marketing'), (4, 'Jhon', 'HR'), (5, 'Jhon Doe', 'HR'), (6, 'Lorem', 'IT'), (8, '', ''), (9, 'khilmi', 'IT'), (11, 'Indra', 'IT')]\n",
      "0. 1 : Alice Johnson : HR\n",
      "1. 2 : Bob Smith : Engineering\n",
      "2. 3 : Charlie Davis : Marketing\n",
      "3. 4 : Jhon : HR\n",
      "4. 5 : Jhon Doe : HR\n",
      "5. 6 : Lorem : IT\n",
      "6. 8 :  : \n",
      "7. 9 : khilmi : IT\n",
      "8. 11 : Indra : IT\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Delete an employee record from the 'Employees' table.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# # Connect to the database\n",
    "# conn = sqlite3.connect('Company.db')\n",
    "# cursor = conn.cursor()\n",
    "\n",
    "# # Delete the employee with ID 3\n",
    "# cursor.execute('''\n",
    "#     DELETE FROM Employees\n",
    "#     WHERE ID = ?\n",
    "# ''', (3,))\n",
    "\n",
    "# # Commit the changes and close the connection\n",
    "# conn.commit()\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Implement a function to delete an employee record based on user input.\n",
    "def delete_employee(employee_id: int):\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        # Delete the employee with the specified ID\n",
    "        cursor.execute('''\n",
    "            DELETE FROM Employees\n",
    "            WHERE ID = ?\n",
    "        ''', (employee_id,))\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "def fetch_all_employee():\n",
    "    try:\n",
    "        # Connect to the database\n",
    "        conn = sqlite3.connect('Company.db')\n",
    "        cursor = conn.cursor()\n",
    "\n",
    "        cursor.execute(f'''\n",
    "            SELECT * FROM Employees;\n",
    "        ''')\n",
    "\n",
    "        result = cursor.fetchall()\n",
    "    except Exception as e:\n",
    "        print(f\"Error exception : {e}\")\n",
    "        result = []\n",
    "    finally:\n",
    "        # Commit the changes and close the connection\n",
    "        conn.commit()\n",
    "        conn.close()\n",
    "\n",
    "    return result\n",
    "\n",
    "def main():\n",
    "    print(\"Employee Management System\")\n",
    "    print(\"Press 1 to delete employee\")\n",
    "    print(\"Press 2 to view all employee\")\n",
    "    print(\"Press 0 to exit\")\n",
    "\n",
    "    while True:\n",
    "        menu_input = int(input(\">> : \\n\"))\n",
    "\n",
    "        if menu_input == 1:\n",
    "            print(\"delete employee\")\n",
    "            try:\n",
    "                employee_id = int(input(\"employee id : \"))\n",
    "            except Exception as e:\n",
    "                print(\"invalid input \")\n",
    "                continue\n",
    "            \n",
    "            delete_employee(employee_id)\n",
    "        \n",
    "        if menu_input == 2:\n",
    "            print(\"view all data\")\n",
    "            data = fetch_all_employee()\n",
    "            print(\"data : \", data)\n",
    "            for index, (id, name, department) in enumerate(data):\n",
    "                print(f\"{index}. {id} : {name} : {department}\")\n",
    "\n",
    "        if menu_input == 0:\n",
    "            break\n",
    "    \n",
    "if __name__ == \"__main__\":\n",
    "    main()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "ename": "OperationalError",
     "evalue": "no such column: Departments.DepartmentName",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mOperationalError\u001b[0m                          Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[2], line 74\u001b[0m\n\u001b[1;32m     71\u001b[0m conn \u001b[38;5;241m=\u001b[39m sqlite3\u001b[38;5;241m.\u001b[39mconnect(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mCompany.db\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m     72\u001b[0m cursor \u001b[38;5;241m=\u001b[39m conn\u001b[38;5;241m.\u001b[39mcursor()\n\u001b[0;32m---> 74\u001b[0m \u001b[43mcursor\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mexecute\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'''\u001b[39;49m\n\u001b[1;32m     75\u001b[0m \u001b[38;5;124;43m    SELECT Employees.Name, Departments.DepartmentName\u001b[39;49m\n\u001b[1;32m     76\u001b[0m \u001b[38;5;124;43m    FROM Employees\u001b[39;49m\n\u001b[1;32m     77\u001b[0m \u001b[38;5;124;43m    JOIN DepartmentAssignments ON Employees.ID = DepartmentAssignments.EmployeeID\u001b[39;49m\n\u001b[1;32m     78\u001b[0m \u001b[38;5;124;43m'''\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[1;32m     79\u001b[0m     \u001b[38;5;66;03m# JOIN Departments ON DepartmentAssignments.DepartmentID = Departments.DepartmentID\u001b[39;00m\n\u001b[1;32m     80\u001b[0m rows \u001b[38;5;241m=\u001b[39m cursor\u001b[38;5;241m.\u001b[39mfetchall()\n",
      "\u001b[0;31mOperationalError\u001b[0m: no such column: Departments.DepartmentName"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Retrieve and display employee records along with their department names using a JOIN operation.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# Connect to the database\n",
    "conn = sqlite3.connect('Company.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "# # Create a 'Departments' table\n",
    "# cursor.execute('''\n",
    "#     CREATE TABLE IF NOT EXISTS Departments (\n",
    "#         DepartmentID INTEGER PRIMARY KEY,\n",
    "#         DepartmentName TEXT NOT NULL\n",
    "#     )\n",
    "# ''')\n",
    "\n",
    "# # Insert sample department records\n",
    "# departments = [\n",
    "#     (1, 'HR'),\n",
    "#     (2, 'Engineering'),\n",
    "#     (3, 'Marketing'),\n",
    "#     (4, 'Sales')\n",
    "# ]\n",
    "\n",
    "# cursor.executemany('''\n",
    "#     INSERT INTO Departments (DepartmentID, DepartmentName)\n",
    "#     VALUES (?, ?)\n",
    "# ''', departments)\n",
    "\n",
    "# # Create a 'DepartmentAssignments' table to link employees to departments\n",
    "# cursor.execute('''\n",
    "#     CREATE TABLE IF NOT EXISTS DepartmentAssignments (\n",
    "#         EmployeeID INTEGER,\n",
    "#         DepartmentID INTEGER,\n",
    "#         FOREIGN KEY (EmployeeID) REFERENCES Employees(ID),\n",
    "#         FOREIGN KEY (DepartmentID) REFERENCES Departments(DepartmentID)\n",
    "#     )\n",
    "# ''')\n",
    "\n",
    "# # Assign employees to departments\n",
    "# assignments = [\n",
    "#     (1, 1),  # Alice Johnson to HR\n",
    "#     (2, 2),  # Bob Smith to Engineering\n",
    "#     (4, 4)   # Charlie Davis to Sales\n",
    "# ]\n",
    "\n",
    "# cursor.executemany('''\n",
    "#     INSERT INTO DepartmentAssignments (EmployeeID, DepartmentID)\n",
    "#     VALUES (?, ?)\n",
    "# ''', assignments)\n",
    "\n",
    "# # Retrieve employee names along with their department names\n",
    "# cursor.execute('''\n",
    "#     SELECT Employees.Name, Departments.DepartmentName\n",
    "#     FROM Employees\n",
    "#     JOIN DepartmentAssignments ON Employees.ID = DepartmentAssignments.EmployeeID\n",
    "#     JOIN Departments ON DepartmentAssignments.DepartmentID = Departments.DepartmentID\n",
    "# ''')\n",
    "# rows = cursor.fetchall()\n",
    "\n",
    "# # Display the records\n",
    "# for row in rows:\n",
    "#     print(row)\n",
    "\n",
    "# # Commit the changes and close the connection\n",
    "# conn.commit()\n",
    "# conn.close()\n",
    "\n",
    "# TODO: Modify the query to include employees who are not assigned to any department.\n",
    "conn = sqlite3.connect('Company.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "cursor.execute('''\n",
    "    SELECT Employees.Name, Departments.DepartmentName\n",
    "    FROM Employees\n",
    "    JOIN DepartmentAssignments ON Employees.ID = DepartmentAssignments.EmployeeID\n",
    "    LEFT JOIN Departments ON DepartmentAssignments.DepartmentID = Departments.DepartmentID\n",
    "''')\n",
    "rows = cursor.fetchall()\n",
    "\n",
    "# Display the records\n",
    "for row in rows:\n",
    "    print(row)\n",
    "\n",
    "# Commit the changes and close the connection\n",
    "conn.commit()\n",
    "conn.close()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Department: Engineering, Employee Count: 1\n",
      "Department: HR, Employee Count: 1\n",
      "Department: Marketing, Employee Count: 0\n",
      "Department: Sales, Employee Count: 1\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Objective: Calculate and display the total number of employees in each department.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# Connect to the database\n",
    "conn = sqlite3.connect('Company.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "# Retrieve the count of employees in each department\n",
    "cursor.execute('''\n",
    "    SELECT Departments.DepartmentName, COUNT(Employees.ID) AS EmployeeCount\n",
    "    FROM Departments\n",
    "    LEFT JOIN DepartmentAssignments ON Departments.DepartmentID = DepartmentAssignments.DepartmentID\n",
    "    LEFT JOIN Employees ON DepartmentAssignments.EmployeeID = Employees.ID\n",
    "    GROUP BY Departments.DepartmentName\n",
    "''')\n",
    "rows = cursor.fetchall()\n",
    "\n",
    "# Display the records\n",
    "for row in rows:\n",
    "    print(f\"Department: {row[0]}, Employee Count: {row[1]}\")\n",
    "\n",
    "# Close the connection\n",
    "conn.close()\n",
    "\n",
    "# TODO: Modify the query to include departments with zero employees.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\"\"\"\n",
    "Objective: Retrieve and display the names of employees working in the department with the most employees.\n",
    "\"\"\"\n",
    "import sqlite3\n",
    "\n",
    "# Connect to the database\n",
    "conn = sqlite3.connect('Company.db')\n",
    "cursor = conn.cursor()\n",
    "\n",
    "# Retrieve the department with the most employees\n",
    "cursor.execute('''\n",
    "    SELECT DepartmentName\n",
    "    FROM Departments\n",
    "    WHERE DepartmentID = (\n",
    "        SELECT DepartmentID\n",
    "        FROM DepartmentAssignments\n",
    "        GROUP BY DepartmentID\n",
    "        ORDER BY COUNT(*) DESC\n",
    "        LIMIT 1\n",
    "    )\n",
    "''')\n",
    "department_name = cursor.fetchone()[0]\n",
    "\n",
    "# Retrieve employee names from the department with the most employees\n",
    "cursor.execute('''\n",
    "    SELECT Employees.Name\n",
    "    FROM Employees\n",
    "    JOIN DepartmentAssignments ON Employees.ID = DepartmentAssignments.EmployeeID\n",
    "    JOIN Departments ON DepartmentAssignments.DepartmentID = Departments.DepartmentID\n",
    "    WHERE Departments.DepartmentName = ?\n",
    "''', (department_name,))\n",
    "rows = cursor.fetchall()\n",
    "\n",
    "# Display the records\n",
    "print(f\"Employees in the department with the most employees ({department_name}):\")\n",
    "for row in rows:\n",
    "    print(row[0])\n",
    "\n",
    "# Commit the changes and close the connection\n",
    "conn.commit()\n",
    "conn.close()\n",
    "\n",
    "# TODO: Modify the query to also include the number of employees in the department.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### **Reflection**\n",
    "In your opinion, which SQL operation (such as querying data, using joins, or applying aggregate functions) do you think is the most important when working with databases, and why?\n",
    "\n",
    "(answer here)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### **Exploration**\n",
    "Although SQL is powerful, it’s worth exploring NoSQL databases (like MongoDB and Cassandra), which offer a different way to structure and access data, especially for unstructured data or high-volume use cases.\n",
    "\n",
    "For more advanced SQL practice please refer to https://www.hackerrank.com/domains/sql"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
